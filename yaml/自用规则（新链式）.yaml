port: 7890
socks-port: 7891
allow-lan: false
mode: rule
log-level: info
external-controller: 127.0.0.1:9090

dns:
  enable: true
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
  fallback:
    - 8.8.8.8
    - 1.1.1.1

profile:
  store-selected: true
  store-fake-ip: true

geodata-mode: true
geo-auto-update: true
geo-update-interval: 24

geox-url:
  geoip: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat
  geosite: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat

proxy-groups:
  - name: 主力
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Proxy.png
    type: select
    include-all: true
    filter: (?i)(ix|bage|cf|jinx|bero|bwh|riddler|yyy|深港出口|出口|megabox|深港|IEPL|CNFaster|Renet|Karvl|DMIT|Zouter|JPSB|legend|洛杉矶)|(?-i)aws
    proxies:
      - 落地
      - 备用

  - name: 备用
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Auto.png
    type: url-test
    include-all: true
    exclude-filter: (?i)(ix|bage|cf|jinx|bero|bwh|riddler|yyy|深港出口|出口|megabox|深港|IEPL|CNFaster|Renet|Karvl|DMIT|Zouter|JPSB|legend|洛杉矶)|(?-i)aws
    interval: 300
    tolerance: 50
    lazy: true

  # ================== 中转 & 落地（dialer-proxy 链式）==================
  - name: 中转
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Router.png
    type: select
    include-all: true
    # 中转组包含 iepl、dmit、megabox
    filter: (?i)(iepl|dmit|megabox)
    proxies:
      - DIRECT

  - name: 落地
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Server.png
    type: select
    include-all: true
    # 落地组只包含“落地”
    filter: (?i)(落地)
    # 落地节点默认先通过中转组当前选中节点
    dialer-proxy: 中转
    proxies:
      - DIRECT
  # =====================================================================

  - name: AI
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Bot.png
    type: select
    include-all: true
    filter: .*
    proxies:
      - 落地
      - 主力
      - 备用

  - name: Google
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Google.png
    type: select
    include-all: true
    filter: .*
    proxies:
      - 落地
      - 主力
      - 备用

  - name: Netflix
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Netflix.png
    type: select
    include-all: true
    filter: .*
    proxies:
      - 落地
      - 主力
      - 备用

  - name: YouTube
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/YouTube.png
    type: select
    include-all: true
    filter: .*
    proxies:
      - 落地
      - 主力
      - 备用

  - name: 广告拦截
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/AdBlack.png
    type: select
    proxies:
      - REJECT
      - DIRECT

rule-providers:
  BanAD:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/BanAD.list
    path: ./ruleset/BanAD.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  AI:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/OpenAi.list
    path: ./ruleset/AI.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  Google:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/Google.list
    path: ./ruleset/Google.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  Netflix:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/Netflix.list
    path: ./ruleset/Netflix.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  YouTube:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/YouTube.list
    path: ./ruleset/YouTube.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  LocalAreaNetwork:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/LocalAreaNetwork.list
    path: ./ruleset/LocalAreaNetwork.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  ChinaDomain:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaDomain.list
    path: ./ruleset/ChinaDomain.list
    behavior: domain
    interval: 86400
    format: text
    type: http

rules:
  - RULE-SET,LocalAreaNetwork,DIRECT
  - RULE-SET,BanAD,广告拦截

  - DOMAIN-SUFFIX,claude.ai,AI
  - DOMAIN-SUFFIX,anthropic.com,AI
  - DOMAIN-SUFFIX,anthropic.ai,AI
  - DOMAIN,x.ai,AI
  - DOMAIN-SUFFIX,x.ai,AI

  # Gemini 不走 AI（强制走 Google）
  - DOMAIN-SUFFIX,gemini.google.com,Google
  - DOMAIN-SUFFIX,ai.google.dev,Google
  - DOMAIN-SUFFIX,generativelanguage.googleapis.com,Google
  - RULE-SET,AI,AI

  # 流媒体
  - RULE-SET,Netflix,Netflix
  - RULE-SET,YouTube,YouTube

  # Google
  - RULE-SET,Google,Google

  # 国内直连
  - RULE-SET,ChinaDomain,DIRECT
  - DOMAIN-SUFFIX,local,DIRECT
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - GEOIP,CN,DIRECT

  # Steam 强制直连
  - DOMAIN-SUFFIX,steamcontent.com,DIRECT
  - DOMAIN-SUFFIX,steamstatic.com,DIRECT
  - DOMAIN-KEYWORD,steamcdn,DIRECT

  - MATCH,主力
